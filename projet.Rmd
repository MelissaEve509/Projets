---
title: "projet"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
install.packages("dplyr")

install.packages("farver")
install.packages("ellipsis")
install.packages("vctrs")
install.packages("askpass")

library(dplyr)
library(tidyverse)
```

# Description du jeu de données

```{r}
library(readxl)

heart = read_csv("heart.csv", col_names = T)
```

```{r}
heart = read.table("heart.csv", header = T, sep = ",", dec = ".", col.names  =  c("age","sex","cp","trestbps","chol","fbs","restecg","thalach","exang","oldpeak","slope","ca","thal","target"), row.names = NULL)
```

```{r}
heart %>% head(10)
```


```{r}
glimpse(heart)
```
on verifie s'il ya des valeurs manquantes (chercher fonction)

=> Description du jeu de données

Tranformation des variables quali en factor 
```{r}
heart %>%
  mutate(
    sex = factor(sex, levels = c(0,1), labels = c("female","male")),
    fbs = factor(fbs, levels = c(0,1), labels = c("Non","Oui"))
  )

```


```{r}
data2 <- heart %>% 
  mutate(sex = if_else(sex == 1, "MALE", "FEMALE"),
         fbs = if_else(fbs == 1, ">120", "<=120"),
         exang = if_else(exang == 1, "YES" ,"NO"),
         cp = if_else(cp == 1, "ATYPICAL ANGINA",
                      if_else(cp == 2, "NON-ANGINAL PAIN", "ASYMPTOMATIC")),
         restecg = if_else(restecg == 0, "NORMAL",
                           if_else(restecg == 1, "ABNORMALITY", "PROBABLE OR DEFINITE")),
         slope = as.factor(slope),
         ca = as.factor(ca),
         thal = as.factor(thal),
         target = if_else(target == 1, "YES", "NO")
         )





# %>% 
  mutate_if(is.character, as.factor) %>% 
  dplyr::select(target, sex, fbs, exang, cp, restecg, slope, ca, thal, everything())
```

=> On renomme ensuite les noms des var pour qu'elles soient plus lisibles (avec rename )

##2. Statistqiue descriptive
```{r}
summary(data2)
```
=> explication 
=> On va decire graphqiuement les variables qui nous interresesent 


```{r}
# Bar plot for target (Heart disease) 
ggplot(data2, aes(x=data2$target, fill=data2$target)) + 
  geom_bar() +
  xlab("Heart Disease") +
  ylab("Count") +
  ggtitle("Analysis of Presence and Absence of Heart Disease") +
  scale_fill_discrete(name = "Heart Disease", labels = c("Absence", "Presence"))

```

On constate que 150 personnes ont une amaldie du coeur (...)

=> Sex + target
=> Sex + cholesterol
=> Sex + pain 

=> Faire des moyennes ou somme des vars en fonction du sexe grace à filter + apply

```{r}

# Representation of Cholestoral level en fonction du sexe
p2<-heart %>% ggplot(aes(x=age,y=chol,col=sex, size=chol))+geom_point(alpha=0.7)+xlab("Age") + 
           ylab("Cholestoral")+guides(fill = guide_legend(title = "Gender"))+
 theme(plot.margin = margin(0.1,.1,.1,.1, "cm"))
p2


```


2) Age 
=> historgalmmem de l'age + boite à moustache 

```{r}

```


=> On decide de recoder la variable Age en 3 classes: jeune / adulte / personne agée 
(fonction mutate ou tranform)
=> donner le nombre de personne pas classe avec un filter + count 

=> on compare ensuite l'age avec les autres variables 

3) 
